--CTEs
WITH CTE_Employee as 
(select FirstName, LastName, Gender, Salary, 
count(Gender) over (Partition by Gender) totalgender
, AVG(Salary) over(Partition by Gender) AvgSalary
from [SQL Tutorial]..[EmployeeDemographics] Demo
Join [SQL Tutorial]..[EmployeeSalary] Demo1
on Demo.EmployeeID=Demo1.EmployeeID
WHERE Salary>'50000'
)
Select *
From  CTE_Employee
.......................................................................
-- Temp Tables
CREATE TABLE #temp_Employee (
EmployeeID int,
JobTitle varchar(50),
Salary int
)

Select *
FROM #temp_Employee

INSERT INTO #temp_Employee VALUES(
1100,'HR',45000)

Select *
FROM #temp_Employee
--THIS IS GOOD USE
INSERT INTO #temp_Employee 
SELECT *
FROM [SQL Tutorial]..EmployeeSalary

Select *
FROM #temp_Employee
....
Create table #temp_employee2 (
JobTitle varchar(100),
EmployeesPerJob int ,
AvgAge int,
AvgSalary int
)


Insert into #temp_employee2
SELECT JobTitle, Count(JobTitle), Avg(Age), AVG(salary)
FROM [SQL Tutorial]..EmployeeDemographics emp
JOIN [SQL Tutorial]..EmployeeSalary sal
	ON emp.EmployeeID = sal.EmployeeID
group by JobTitle

SELECT *
FROM #temp_employee2
